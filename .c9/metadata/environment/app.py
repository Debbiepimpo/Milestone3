{"filter":false,"title":"app.py","tooltip":"/app.py","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":213,"column":47},"end":{"row":213,"column":48},"action":"insert","lines":["r"],"id":3563},{"start":{"row":213,"column":48},"end":{"row":213,"column":49},"action":"insert","lines":["e"]},{"start":{"row":213,"column":49},"end":{"row":213,"column":50},"action":"insert","lines":["c"]},{"start":{"row":213,"column":50},"end":{"row":213,"column":51},"action":"insert","lines":["i"]},{"start":{"row":213,"column":51},"end":{"row":213,"column":52},"action":"insert","lines":["p"]},{"start":{"row":213,"column":52},"end":{"row":213,"column":53},"action":"insert","lines":["e"]}],[{"start":{"row":209,"column":4},"end":{"row":209,"column":5},"action":"insert","lines":["_"],"id":3564}],[{"start":{"row":209,"column":14},"end":{"row":209,"column":15},"action":"insert","lines":["s"],"id":3565}],[{"start":{"row":213,"column":52},"end":{"row":213,"column":53},"action":"remove","lines":["e"],"id":3566},{"start":{"row":213,"column":51},"end":{"row":213,"column":52},"action":"remove","lines":["p"]},{"start":{"row":213,"column":50},"end":{"row":213,"column":51},"action":"remove","lines":["i"]},{"start":{"row":213,"column":49},"end":{"row":213,"column":50},"action":"remove","lines":["c"]},{"start":{"row":213,"column":48},"end":{"row":213,"column":49},"action":"remove","lines":["e"]},{"start":{"row":213,"column":47},"end":{"row":213,"column":48},"action":"remove","lines":["r"]}],[{"start":{"row":213,"column":47},"end":{"row":213,"column":48},"action":"insert","lines":["r"],"id":3567},{"start":{"row":213,"column":48},"end":{"row":213,"column":49},"action":"insert","lines":["e"]},{"start":{"row":213,"column":49},"end":{"row":213,"column":50},"action":"insert","lines":["c"]},{"start":{"row":213,"column":50},"end":{"row":213,"column":51},"action":"insert","lines":["i"]},{"start":{"row":213,"column":51},"end":{"row":213,"column":52},"action":"insert","lines":["p"]},{"start":{"row":213,"column":52},"end":{"row":213,"column":53},"action":"insert","lines":["e"]}],[{"start":{"row":213,"column":52},"end":{"row":213,"column":53},"action":"remove","lines":["e"],"id":3568},{"start":{"row":213,"column":51},"end":{"row":213,"column":52},"action":"remove","lines":["p"]},{"start":{"row":213,"column":50},"end":{"row":213,"column":51},"action":"remove","lines":["i"]},{"start":{"row":213,"column":49},"end":{"row":213,"column":50},"action":"remove","lines":["c"]},{"start":{"row":213,"column":48},"end":{"row":213,"column":49},"action":"remove","lines":["e"]},{"start":{"row":213,"column":47},"end":{"row":213,"column":48},"action":"remove","lines":["r"]}],[{"start":{"row":213,"column":47},"end":{"row":213,"column":48},"action":"insert","lines":["f"],"id":3569},{"start":{"row":213,"column":48},"end":{"row":213,"column":49},"action":"insert","lines":["a"]},{"start":{"row":213,"column":49},"end":{"row":213,"column":50},"action":"insert","lines":["v"]},{"start":{"row":213,"column":50},"end":{"row":213,"column":51},"action":"insert","lines":["o"]},{"start":{"row":213,"column":51},"end":{"row":213,"column":52},"action":"insert","lines":["u"]},{"start":{"row":213,"column":52},"end":{"row":213,"column":53},"action":"insert","lines":["r"]},{"start":{"row":213,"column":53},"end":{"row":213,"column":54},"action":"insert","lines":["i"]},{"start":{"row":213,"column":54},"end":{"row":213,"column":55},"action":"insert","lines":["t"]},{"start":{"row":213,"column":55},"end":{"row":213,"column":56},"action":"insert","lines":["e"]}],[{"start":{"row":209,"column":61},"end":{"row":209,"column":67},"action":"remove","lines":["recipe"],"id":3570},{"start":{"row":209,"column":61},"end":{"row":209,"column":62},"action":"insert","lines":["f"]},{"start":{"row":209,"column":62},"end":{"row":209,"column":63},"action":"insert","lines":["a"]},{"start":{"row":209,"column":63},"end":{"row":209,"column":64},"action":"insert","lines":["v"]},{"start":{"row":209,"column":64},"end":{"row":209,"column":65},"action":"insert","lines":["o"]},{"start":{"row":209,"column":65},"end":{"row":209,"column":66},"action":"insert","lines":["u"]},{"start":{"row":209,"column":66},"end":{"row":209,"column":67},"action":"insert","lines":["r"]},{"start":{"row":209,"column":67},"end":{"row":209,"column":68},"action":"insert","lines":["i"]},{"start":{"row":209,"column":68},"end":{"row":209,"column":69},"action":"insert","lines":["t"]},{"start":{"row":209,"column":69},"end":{"row":209,"column":70},"action":"insert","lines":["e"]}],[{"start":{"row":209,"column":4},"end":{"row":209,"column":5},"action":"remove","lines":["_"],"id":3571},{"start":{"row":209,"column":13},"end":{"row":209,"column":14},"action":"remove","lines":["s"]}],[{"start":{"row":561,"column":4},"end":{"row":562,"column":0},"action":"insert","lines":["",""],"id":3572},{"start":{"row":562,"column":0},"end":{"row":562,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":562,"column":0},"end":{"row":562,"column":4},"action":"remove","lines":["    "],"id":3573}],[{"start":{"row":562,"column":0},"end":{"row":582,"column":41},"action":"insert","lines":["# The user will be able to delete exclusively his own recipes  ","@app.route('/del_recipe/<recipe_id>')","def del_recipe(recipe_id):","    ","    if not loggedOrNot():","        return redirect(url_for('sign_in')) ","    '''","    This make sure if the user is logged with his username and check recipe if it match,","    if the user is not logged, he will be redirected to sign_in. But if the user is logged ","    and the recipe match with the recipe written under the username logged, the recipe will","    be deleted and user will be redirected to the recipes on his own cookbook.","    '''","    user=session['user']    ","    recipe=mongo.db.recipes.find_one({\"_id\":ObjectId(recipe_id)})","    favourite=mongo.db.favourites.find_one({\"_id\":ObjectId(favourite_id)})","    if recipe['user'] != user:","        return redirect(url_for('sign_in'))","    mongo.db.recipes.remove({'_id':ObjectId(recipe_id)})","    mongo.db.favourites.remove({'_id':ObjectId(favourite_id)})","    flash('The recipe is now delete.')","    return redirect(url_for('myrecipes'))"],"id":3574}],[{"start":{"row":195,"column":0},"end":{"row":215,"column":41},"action":"remove","lines":["# The user will be able to delete exclusively his own recipes  ","@app.route('/del_recipe/<recipe_id>')","def del_recipe(recipe_id):","    ","    if not loggedOrNot():","        return redirect(url_for('sign_in')) ","    '''","    This make sure if the user is logged with his username and check recipe if it match,","    if the user is not logged, he will be redirected to sign_in. But if the user is logged ","    and the recipe match with the recipe written under the username logged, the recipe will","    be deleted and user will be redirected to the recipes on his own cookbook.","    '''","    user=session['user']    ","    recipe=mongo.db.recipes.find_one({\"_id\":ObjectId(recipe_id)})","    favourite=mongo.db.favourites.find_one({\"_id\":ObjectId(favourite_id)})","    if recipe['user'] != user:","        return redirect(url_for('sign_in'))","    mongo.db.recipes.remove({'_id':ObjectId(recipe_id)})","    mongo.db.favourites.remove({'_id':ObjectId(favourite_id)})","    flash('The recipe is now delete.')","    return redirect(url_for('myrecipes'))"],"id":3575}],[{"start":{"row":194,"column":0},"end":{"row":195,"column":0},"action":"remove","lines":["",""],"id":3576}],[{"start":{"row":543,"column":24},"end":{"row":543,"column":25},"action":"insert","lines":[","],"id":3577}],[{"start":{"row":543,"column":25},"end":{"row":543,"column":26},"action":"insert","lines":[" "],"id":3578},{"start":{"row":543,"column":26},"end":{"row":543,"column":27},"action":"insert","lines":["f"]},{"start":{"row":543,"column":27},"end":{"row":543,"column":28},"action":"insert","lines":["a"]},{"start":{"row":543,"column":28},"end":{"row":543,"column":29},"action":"insert","lines":["v"]},{"start":{"row":543,"column":29},"end":{"row":543,"column":30},"action":"insert","lines":["o"]},{"start":{"row":543,"column":30},"end":{"row":543,"column":31},"action":"insert","lines":["u"]}],[{"start":{"row":543,"column":31},"end":{"row":543,"column":32},"action":"insert","lines":["r"],"id":3579},{"start":{"row":543,"column":32},"end":{"row":543,"column":33},"action":"insert","lines":["i"]},{"start":{"row":543,"column":33},"end":{"row":543,"column":34},"action":"insert","lines":["t"]},{"start":{"row":543,"column":34},"end":{"row":543,"column":35},"action":"insert","lines":["e"]},{"start":{"row":543,"column":35},"end":{"row":543,"column":36},"action":"insert","lines":["_"]},{"start":{"row":543,"column":36},"end":{"row":543,"column":37},"action":"insert","lines":["i"]},{"start":{"row":543,"column":37},"end":{"row":543,"column":38},"action":"insert","lines":["d"]},{"start":{"row":543,"column":38},"end":{"row":543,"column":39},"action":"insert","lines":["e"]}],[{"start":{"row":543,"column":38},"end":{"row":543,"column":39},"action":"remove","lines":["e"],"id":3580}],[{"start":{"row":561,"column":41},"end":{"row":562,"column":0},"action":"insert","lines":["",""],"id":3581},{"start":{"row":562,"column":0},"end":{"row":562,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":542,"column":35},"end":{"row":542,"column":36},"action":"insert","lines":["/"],"id":3582}],[{"start":{"row":542,"column":36},"end":{"row":542,"column":37},"action":"insert","lines":["<"],"id":3583},{"start":{"row":542,"column":37},"end":{"row":542,"column":38},"action":"insert","lines":["f"]},{"start":{"row":542,"column":38},"end":{"row":542,"column":39},"action":"insert","lines":["a"]},{"start":{"row":542,"column":39},"end":{"row":542,"column":40},"action":"insert","lines":["v"]},{"start":{"row":542,"column":40},"end":{"row":542,"column":41},"action":"insert","lines":["o"]},{"start":{"row":542,"column":41},"end":{"row":542,"column":42},"action":"insert","lines":["u"]},{"start":{"row":542,"column":42},"end":{"row":542,"column":43},"action":"insert","lines":["r"]}],[{"start":{"row":542,"column":43},"end":{"row":542,"column":44},"action":"insert","lines":["i"],"id":3584},{"start":{"row":542,"column":44},"end":{"row":542,"column":45},"action":"insert","lines":["t"]},{"start":{"row":542,"column":45},"end":{"row":542,"column":46},"action":"insert","lines":["e"]},{"start":{"row":542,"column":46},"end":{"row":542,"column":47},"action":"insert","lines":["_"]},{"start":{"row":542,"column":47},"end":{"row":542,"column":48},"action":"insert","lines":["i"]},{"start":{"row":542,"column":48},"end":{"row":542,"column":49},"action":"insert","lines":["d"]}],[{"start":{"row":542,"column":49},"end":{"row":542,"column":50},"action":"insert","lines":[">"],"id":3585}],[{"start":{"row":555,"column":13},"end":{"row":555,"column":14},"action":"insert","lines":["I"],"id":3586},{"start":{"row":555,"column":14},"end":{"row":555,"column":15},"action":"insert","lines":["d"]}],[{"start":{"row":555,"column":14},"end":{"row":555,"column":15},"action":"remove","lines":["d"],"id":3587},{"start":{"row":555,"column":13},"end":{"row":555,"column":14},"action":"remove","lines":["I"]}],[{"start":{"row":555,"column":13},"end":{"row":555,"column":14},"action":"insert","lines":["s"],"id":3588}],[{"start":{"row":555,"column":13},"end":{"row":555,"column":14},"action":"remove","lines":["s"],"id":3589}],[{"start":{"row":555,"column":72},"end":{"row":555,"column":73},"action":"insert","lines":[","],"id":3590}],[{"start":{"row":555,"column":72},"end":{"row":555,"column":73},"action":"remove","lines":[","],"id":3594}],[{"start":{"row":555,"column":4},"end":{"row":555,"column":14},"action":"remove","lines":["favourite="],"id":3595}],[{"start":{"row":555,"column":4},"end":{"row":555,"column":5},"action":"insert","lines":["f"],"id":3596},{"start":{"row":555,"column":5},"end":{"row":555,"column":6},"action":"insert","lines":["a"]},{"start":{"row":555,"column":6},"end":{"row":555,"column":7},"action":"insert","lines":["v"]},{"start":{"row":555,"column":7},"end":{"row":555,"column":8},"action":"insert","lines":["o"]}],[{"start":{"row":555,"column":8},"end":{"row":555,"column":9},"action":"insert","lines":["u"],"id":3597},{"start":{"row":555,"column":9},"end":{"row":555,"column":10},"action":"insert","lines":["r"]},{"start":{"row":555,"column":10},"end":{"row":555,"column":11},"action":"insert","lines":["i"]},{"start":{"row":555,"column":11},"end":{"row":555,"column":12},"action":"insert","lines":["t"]},{"start":{"row":555,"column":12},"end":{"row":555,"column":13},"action":"insert","lines":["e"]}],[{"start":{"row":555,"column":13},"end":{"row":555,"column":14},"action":"insert","lines":["="],"id":3598}],[{"start":{"row":555,"column":4},"end":{"row":555,"column":14},"action":"remove","lines":["favourite="],"id":3599}],[{"start":{"row":555,"column":4},"end":{"row":555,"column":64},"action":"remove","lines":["mongo.db.favourites.find_one({\"_id\":ObjectId(favourite_id)})"],"id":3600},{"start":{"row":555,"column":0},"end":{"row":555,"column":4},"action":"remove","lines":["    "]},{"start":{"row":554,"column":65},"end":{"row":555,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":558,"column":3},"end":{"row":558,"column":62},"action":"remove","lines":[" mongo.db.favourites.remove({'_id':ObjectId(favourite_id)})"],"id":3601},{"start":{"row":558,"column":2},"end":{"row":558,"column":3},"action":"remove","lines":[" "]},{"start":{"row":558,"column":1},"end":{"row":558,"column":2},"action":"remove","lines":[" "]},{"start":{"row":558,"column":0},"end":{"row":558,"column":1},"action":"remove","lines":[" "]},{"start":{"row":557,"column":56},"end":{"row":558,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":543,"column":25},"end":{"row":543,"column":38},"action":"remove","lines":[" favourite_id"],"id":3602},{"start":{"row":543,"column":24},"end":{"row":543,"column":25},"action":"remove","lines":[","]}],[{"start":{"row":542,"column":35},"end":{"row":542,"column":50},"action":"remove","lines":["/<favourite_id>"],"id":3603}],[{"start":{"row":554,"column":65},"end":{"row":555,"column":0},"action":"insert","lines":["",""],"id":3604},{"start":{"row":555,"column":0},"end":{"row":555,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":555,"column":4},"end":{"row":555,"column":69},"action":"insert","lines":["mongo.db.favourites.find_one({\"recipe_id\":recipe_id,\"user\":user})"],"id":3605}],[{"start":{"row":558,"column":56},"end":{"row":559,"column":0},"action":"insert","lines":["",""],"id":3606},{"start":{"row":559,"column":0},"end":{"row":559,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":559,"column":4},"end":{"row":559,"column":61},"action":"insert","lines":["mongo.db.favourites.remove({'_id':ObjectId(favouriteId)})"],"id":3607}],[{"start":{"row":555,"column":4},"end":{"row":555,"column":5},"action":"insert","lines":["f"],"id":3608},{"start":{"row":555,"column":5},"end":{"row":555,"column":6},"action":"insert","lines":["a"]},{"start":{"row":555,"column":6},"end":{"row":555,"column":7},"action":"insert","lines":["v"]},{"start":{"row":555,"column":7},"end":{"row":555,"column":8},"action":"insert","lines":["o"]},{"start":{"row":555,"column":8},"end":{"row":555,"column":9},"action":"insert","lines":["u"]},{"start":{"row":555,"column":9},"end":{"row":555,"column":10},"action":"insert","lines":["r"]},{"start":{"row":555,"column":10},"end":{"row":555,"column":11},"action":"insert","lines":["i"]},{"start":{"row":555,"column":11},"end":{"row":555,"column":12},"action":"insert","lines":["t"]},{"start":{"row":555,"column":12},"end":{"row":555,"column":13},"action":"insert","lines":["e"]}],[{"start":{"row":555,"column":13},"end":{"row":555,"column":14},"action":"insert","lines":["I"],"id":3609},{"start":{"row":555,"column":14},"end":{"row":555,"column":15},"action":"insert","lines":["d"]},{"start":{"row":555,"column":15},"end":{"row":555,"column":16},"action":"insert","lines":["="]}],[{"start":{"row":555,"column":4},"end":{"row":555,"column":81},"action":"remove","lines":["favouriteId=mongo.db.favourites.find_one({\"recipe_id\":recipe_id,\"user\":user})"],"id":3610},{"start":{"row":555,"column":0},"end":{"row":555,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":554,"column":65},"end":{"row":555,"column":0},"action":"remove","lines":["",""],"id":3611}],[{"start":{"row":558,"column":2},"end":{"row":558,"column":61},"action":"remove","lines":["  mongo.db.favourites.remove({'_id':ObjectId(favouriteId)})"],"id":3612},{"start":{"row":558,"column":1},"end":{"row":558,"column":2},"action":"remove","lines":[" "]},{"start":{"row":558,"column":0},"end":{"row":558,"column":1},"action":"remove","lines":[" "]},{"start":{"row":557,"column":56},"end":{"row":558,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":336,"column":64},"end":{"row":336,"column":65},"action":"insert","lines":["i"],"id":3614},{"start":{"row":336,"column":65},"end":{"row":336,"column":66},"action":"insert","lines":["n"]},{"start":{"row":336,"column":66},"end":{"row":336,"column":67},"action":"insert","lines":["s"]},{"start":{"row":336,"column":67},"end":{"row":336,"column":68},"action":"insert","lines":["t"]},{"start":{"row":336,"column":68},"end":{"row":336,"column":69},"action":"insert","lines":["r"]},{"start":{"row":336,"column":69},"end":{"row":336,"column":70},"action":"insert","lines":["u"]},{"start":{"row":336,"column":70},"end":{"row":336,"column":71},"action":"insert","lines":["c"]}],[{"start":{"row":336,"column":71},"end":{"row":336,"column":72},"action":"insert","lines":["t"],"id":3615},{"start":{"row":336,"column":72},"end":{"row":336,"column":73},"action":"insert","lines":["i"]},{"start":{"row":336,"column":73},"end":{"row":336,"column":74},"action":"insert","lines":["o"]}],[{"start":{"row":336,"column":73},"end":{"row":336,"column":74},"action":"remove","lines":["o"],"id":3616},{"start":{"row":336,"column":72},"end":{"row":336,"column":73},"action":"remove","lines":["i"]},{"start":{"row":336,"column":71},"end":{"row":336,"column":72},"action":"remove","lines":["t"]},{"start":{"row":336,"column":70},"end":{"row":336,"column":71},"action":"remove","lines":["c"]},{"start":{"row":336,"column":69},"end":{"row":336,"column":70},"action":"remove","lines":["u"]},{"start":{"row":336,"column":68},"end":{"row":336,"column":69},"action":"remove","lines":["r"]},{"start":{"row":336,"column":67},"end":{"row":336,"column":68},"action":"remove","lines":["t"]},{"start":{"row":336,"column":66},"end":{"row":336,"column":67},"action":"remove","lines":["s"]},{"start":{"row":336,"column":65},"end":{"row":336,"column":66},"action":"remove","lines":["n"]},{"start":{"row":336,"column":64},"end":{"row":336,"column":65},"action":"remove","lines":["i"]}],[{"start":{"row":336,"column":64},"end":{"row":336,"column":65},"action":"insert","lines":["i"],"id":3617},{"start":{"row":336,"column":65},"end":{"row":336,"column":66},"action":"insert","lines":["n"]},{"start":{"row":336,"column":66},"end":{"row":336,"column":67},"action":"insert","lines":["s"]},{"start":{"row":336,"column":67},"end":{"row":336,"column":68},"action":"insert","lines":["t"]},{"start":{"row":336,"column":68},"end":{"row":336,"column":69},"action":"insert","lines":["r"]},{"start":{"row":336,"column":69},"end":{"row":336,"column":70},"action":"insert","lines":["u"]},{"start":{"row":336,"column":70},"end":{"row":336,"column":71},"action":"insert","lines":["c"]},{"start":{"row":336,"column":71},"end":{"row":336,"column":72},"action":"insert","lines":["t"]}],[{"start":{"row":336,"column":72},"end":{"row":336,"column":73},"action":"insert","lines":["i"],"id":3618},{"start":{"row":336,"column":73},"end":{"row":336,"column":74},"action":"insert","lines":["o"]},{"start":{"row":336,"column":74},"end":{"row":336,"column":75},"action":"insert","lines":["n"]},{"start":{"row":336,"column":75},"end":{"row":336,"column":76},"action":"insert","lines":["s"]},{"start":{"row":336,"column":76},"end":{"row":336,"column":77},"action":"insert","lines":["="]}],[{"start":{"row":336,"column":77},"end":{"row":336,"column":78},"action":"insert","lines":["i"],"id":3619},{"start":{"row":336,"column":78},"end":{"row":336,"column":79},"action":"insert","lines":["n"]},{"start":{"row":336,"column":79},"end":{"row":336,"column":80},"action":"insert","lines":["s"]},{"start":{"row":336,"column":80},"end":{"row":336,"column":81},"action":"insert","lines":["t"]},{"start":{"row":336,"column":81},"end":{"row":336,"column":82},"action":"insert","lines":["r"]},{"start":{"row":336,"column":82},"end":{"row":336,"column":83},"action":"insert","lines":["u"]},{"start":{"row":336,"column":83},"end":{"row":336,"column":84},"action":"insert","lines":["c"]},{"start":{"row":336,"column":84},"end":{"row":336,"column":85},"action":"insert","lines":["t"]}],[{"start":{"row":336,"column":85},"end":{"row":336,"column":86},"action":"insert","lines":["i"],"id":3620},{"start":{"row":336,"column":86},"end":{"row":336,"column":87},"action":"insert","lines":["o"]},{"start":{"row":336,"column":87},"end":{"row":336,"column":88},"action":"insert","lines":["n"]},{"start":{"row":336,"column":88},"end":{"row":336,"column":89},"action":"insert","lines":["s"]},{"start":{"row":336,"column":89},"end":{"row":336,"column":90},"action":"insert","lines":[","]}],[{"start":{"row":336,"column":89},"end":{"row":336,"column":90},"action":"remove","lines":[","],"id":3621},{"start":{"row":336,"column":88},"end":{"row":336,"column":89},"action":"remove","lines":["s"]},{"start":{"row":336,"column":87},"end":{"row":336,"column":88},"action":"remove","lines":["n"]},{"start":{"row":336,"column":86},"end":{"row":336,"column":87},"action":"remove","lines":["o"]},{"start":{"row":336,"column":85},"end":{"row":336,"column":86},"action":"remove","lines":["i"]},{"start":{"row":336,"column":84},"end":{"row":336,"column":85},"action":"remove","lines":["t"]},{"start":{"row":336,"column":83},"end":{"row":336,"column":84},"action":"remove","lines":["c"]},{"start":{"row":336,"column":82},"end":{"row":336,"column":83},"action":"remove","lines":["u"]},{"start":{"row":336,"column":81},"end":{"row":336,"column":82},"action":"remove","lines":["r"]},{"start":{"row":336,"column":80},"end":{"row":336,"column":81},"action":"remove","lines":["t"]},{"start":{"row":336,"column":79},"end":{"row":336,"column":80},"action":"remove","lines":["s"]},{"start":{"row":336,"column":78},"end":{"row":336,"column":79},"action":"remove","lines":["n"]},{"start":{"row":336,"column":77},"end":{"row":336,"column":78},"action":"remove","lines":["i"]},{"start":{"row":336,"column":76},"end":{"row":336,"column":77},"action":"remove","lines":["="]},{"start":{"row":336,"column":75},"end":{"row":336,"column":76},"action":"remove","lines":["s"]},{"start":{"row":336,"column":74},"end":{"row":336,"column":75},"action":"remove","lines":["n"]},{"start":{"row":336,"column":73},"end":{"row":336,"column":74},"action":"remove","lines":["o"]},{"start":{"row":336,"column":72},"end":{"row":336,"column":73},"action":"remove","lines":["i"]},{"start":{"row":336,"column":71},"end":{"row":336,"column":72},"action":"remove","lines":["t"]},{"start":{"row":336,"column":70},"end":{"row":336,"column":71},"action":"remove","lines":["c"]},{"start":{"row":336,"column":69},"end":{"row":336,"column":70},"action":"remove","lines":["u"]},{"start":{"row":336,"column":68},"end":{"row":336,"column":69},"action":"remove","lines":["r"]},{"start":{"row":336,"column":67},"end":{"row":336,"column":68},"action":"remove","lines":["t"]}],[{"start":{"row":336,"column":66},"end":{"row":336,"column":67},"action":"remove","lines":["s"],"id":3622},{"start":{"row":336,"column":65},"end":{"row":336,"column":66},"action":"remove","lines":["n"]},{"start":{"row":336,"column":64},"end":{"row":336,"column":65},"action":"remove","lines":["i"]}],[{"start":{"row":315,"column":44},"end":{"row":315,"column":45},"action":"remove","lines":[" "],"id":3623}],[{"start":{"row":68,"column":81},"end":{"row":68,"column":82},"action":"remove","lines":["6"],"id":3624}],[{"start":{"row":68,"column":81},"end":{"row":68,"column":82},"action":"insert","lines":["3"],"id":3625}],[{"start":{"row":557,"column":56},"end":{"row":558,"column":0},"action":"insert","lines":["",""],"id":3659},{"start":{"row":558,"column":0},"end":{"row":558,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":558,"column":4},"end":{"row":558,"column":59},"action":"insert","lines":["    mongo.db.favourites.remove({'recipe_id':recipe_id})"],"id":3660}],[{"start":{"row":558,"column":4},"end":{"row":558,"column":8},"action":"remove","lines":["    "],"id":3661}],[{"start":{"row":322,"column":10},"end":{"row":322,"column":11},"action":"insert","lines":["s"],"id":3662}],[{"start":{"row":322,"column":12},"end":{"row":322,"column":18},"action":"remove","lines":["update"],"id":3663},{"start":{"row":322,"column":12},"end":{"row":322,"column":22},"action":"insert","lines":["update_one"]}],[{"start":{"row":322,"column":53},"end":{"row":322,"column":62},"action":"insert","lines":["{ \"$set\":"],"id":3664}],[{"start":{"row":331,"column":5},"end":{"row":331,"column":6},"action":"insert","lines":["}"],"id":3665}],[{"start":{"row":331,"column":5},"end":{"row":333,"column":4},"action":"insert","lines":["","        ","    "],"id":3667}],[{"start":{"row":332,"column":4},"end":{"row":332,"column":8},"action":"remove","lines":["    "],"id":3668},{"start":{"row":332,"column":0},"end":{"row":332,"column":4},"action":"remove","lines":["    "]},{"start":{"row":331,"column":5},"end":{"row":332,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":332,"column":6},"end":{"row":333,"column":0},"action":"insert","lines":["",""],"id":3670},{"start":{"row":333,"column":0},"end":{"row":333,"column":4},"action":"insert","lines":["    "]},{"start":{"row":333,"column":4},"end":{"row":333,"column":5},"action":"insert","lines":["r"]},{"start":{"row":333,"column":5},"end":{"row":333,"column":6},"action":"insert","lines":["e"]},{"start":{"row":333,"column":6},"end":{"row":333,"column":7},"action":"insert","lines":["c"]},{"start":{"row":333,"column":7},"end":{"row":333,"column":8},"action":"insert","lines":["i"]}],[{"start":{"row":333,"column":8},"end":{"row":333,"column":9},"action":"insert","lines":["p"],"id":3671},{"start":{"row":333,"column":9},"end":{"row":333,"column":10},"action":"insert","lines":["e"]}],[{"start":{"row":333,"column":10},"end":{"row":333,"column":11},"action":"insert","lines":[" "],"id":3672}],[{"start":{"row":333,"column":10},"end":{"row":333,"column":11},"action":"remove","lines":[" "],"id":3673}],[{"start":{"row":333,"column":10},"end":{"row":333,"column":11},"action":"insert","lines":["="],"id":3674}],[{"start":{"row":333,"column":11},"end":{"row":333,"column":65},"action":"insert","lines":["mongo.db.recipes.find_one({\"_id\":ObjectId(recipe_id)})"],"id":3675}],[{"start":{"row":335,"column":73},"end":{"row":335,"column":74},"action":"remove","lines":["s"],"id":3676}],[{"start":{"row":335,"column":44},"end":{"row":335,"column":58},"action":"remove","lines":[",recipe=recipe"],"id":3677}],[{"start":{"row":335,"column":51},"end":{"row":335,"column":52},"action":"remove","lines":["s"],"id":3678}],[{"start":{"row":342,"column":16},"end":{"row":342,"column":17},"action":"insert","lines":[" "],"id":3679}],[{"start":{"row":353,"column":4},"end":{"row":354,"column":0},"action":"insert","lines":["",""],"id":3680},{"start":{"row":354,"column":0},"end":{"row":354,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":354,"column":0},"end":{"row":354,"column":4},"action":"remove","lines":["    "],"id":3681},{"start":{"row":353,"column":4},"end":{"row":354,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":353,"column":4},"end":{"row":354,"column":0},"action":"insert","lines":["",""],"id":3682},{"start":{"row":354,"column":0},"end":{"row":354,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":354,"column":0},"end":{"row":354,"column":4},"action":"remove","lines":["    "],"id":3683},{"start":{"row":353,"column":4},"end":{"row":354,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":332,"column":6},"end":{"row":333,"column":65},"action":"remove","lines":["","    recipe=mongo.db.recipes.find_one({\"_id\":ObjectId(recipe_id)})"],"id":3684}],[{"start":{"row":334,"column":52},"end":{"row":334,"column":58},"action":"remove","lines":["recipe"],"id":3685},{"start":{"row":334,"column":52},"end":{"row":334,"column":58},"action":"insert","lines":["recipe"]}],[{"start":{"row":232,"column":3},"end":{"row":321,"column":30},"action":"remove","lines":[" message=\"\"","    keys=[] # This will store the keys from the fields that are empty","    # Get the recipe from mongoDB","    recipe=mongo.db.recipes.find_one({\"_id\":ObjectId(recipe_id)})","    # Take the data written into the form and convert into dictionary","    recipes=request.form.to_dict()","  ","    ingredient_length=len(request.form.getlist(\"ingredientName[]\"))","    instructions_length=len(request.form.getlist(\"instructions\"))","    ","    # This will create an array with the name, the quantity and the measurements of each ingredient","    headers = ('name', 'quantity','measurements')","    values = (","        request.form.getlist('ingredientName[]'),","        request.form.getlist('ingredientQuantity[]'),","        request.form.getlist('ingredientMeasurements[]'),","    )","    items = [{} for i in range(len(values[0]))]","    for x,i in enumerate(values):","        for _x,_i in enumerate(i):","            items[_x][headers[x]] = _i","    ","    # Take instructions and allergies writen into the form","    form_allergies = request.form.getlist(\"allergies[]\")","    print(form_allergies)","    form_instructions = request.form.getlist(\"instructions\")","    ","    #Delete the name, the quantity and the measurements when this are not required by the format for mongoDB","    del recipes[\"ingredientName[]\"]","    del recipes[\"ingredientQuantity[]\"]","    del recipes[\"ingredientMeasurements[]\"]","    del recipes[\"instructions\"]","   ","    # Put the data into the dictionary","    recipes[\"ingredients\"]=items","    recipes[\"instructions\"]=form_instructions","    ","    if form_allergies:","        del recipes[\"allergies[]\"]","        recipes[\"allergies\"]=form_allergies","    else:","        recipes[\"allergies\"]=[\"None\"]","        ","    if request.form.get('submit') == 'submit':","        #If there's no image link provided a image settled as default will be used","        if request.form[\"image\"]==\"\":","            request.form[\"image\"]=\"../static/img/default.jpg\"","","        # Check allergies, description and recipe name only, to make sure if the key length has a value equals to 0 ","        keys = [key for key,val in recipes.items() if not val]","        # Check also ingredients and instructions","        keys_ingredients = [val for val in recipes[\"ingredients\"] if not val[\"measurements\"] or not val[\"name\"] or not val[\"quantity\"]]","        keys_instructions = [val for val in recipes[\"instructions\"] if not val]","         # If cuisine not able at the dictionary    ","        if 'cuisine' not in recipes:","            keys.append('cuisine')","        # If diet is not able at the dictionary ","        if 'diet' not in recipes:","            keys.append('diet')","        # If ingredients and instructions have no values into the array, then it will contain empy keys","        if keys_ingredients:","            keys.append('ingredients')","        if keys_instructions:","            keys.append('instructions')","        if keys:","            message=\"This fields are required. Please fill them in.\"","        else:","            recipes=mongo.db.recipes","            recipes.update_one({'_id': ObjectId(recipe_id)},{\"$set\":recipes})  ","            flash('The recipe has being updated')","            return redirect(url_for('myrecipes'))","        ","    elif request.form.get('submit') == 'addInstruction':","        instructions_length += 1","    elif request.form.get('submit') == 'addIngredient': ","        ingredient_length += 1","    elif request.form.get('submit') == 'del_instruction':","        instructions_length -= 1 ","    elif request.form.get('submit') == 'del_ingredient':  ","        ingredient_length -= 1","    _diet=mongo.db.diet.find()","    diet=[diet for diet in _diet]","    _cuisine=mongo.db.cuisine.find()","    cuisine=[cuisine for cuisine in _cuisine]","    _allergies=mongo.db.allergies.find()","    allergies=[allergy for allergy in _allergies]","    _measurements=mongo.db.measurements.find()","    measurements=[unit for unit in _measurements]","    ","    recipes = mongo.db.recipes"],"id":3686},{"start":{"row":232,"column":3},"end":{"row":321,"column":24},"action":"insert","lines":["message=\"\"","    keys=[] # It will store keys of empty fields","","    # This are the list from mongoDB","    _measurements=mongo.db.measurements.find()","    measurements=[measurement for measurement in _measurements]","    _cuisine=mongo.db.cuisine.find()","    cuisine=[cuisine for cuisine in _cuisine ]","    _diet=mongo.db.diet.find()","    diet=[diet for diet in _diet]","    _allergies=mongo.db.allergies.find()","    allergies=[allergy for allergy in _allergies]","    ","    instructions = len(request.form.getlist(\"instructions\"))","  ","    ingredientsList = request.form.getlist(\"ingredientName[]\")","    ingredients = len(ingredientsList)","    ","    # Array of tuples for each ingredient","    recipe=request.form.to_dict()","    headers = ('name', 'quantity','measurements')","    values = (","        request.form.getlist('ingredientName[]'),","        request.form.getlist('ingredientQuantity[]'),","        request.form.getlist('ingredientMeasurements[]'),","    )","    items = [{} for i in range(len(values[0]))]","    for x,i in enumerate(values):","        for _x,_i in enumerate(i):","            items[_x][headers[x]] = _i","    ","    form_allergies = request.form.getlist(\"allergies[]\")","    form_instructions = request.form.getlist(\"instructions\")","    ","    # To delete the extra lines of ingredients and instructions","    del recipe[\"ingredientName[]\"]","    del recipe[\"ingredientQuantity[]\"]","    del recipe[\"ingredientMeasurements[]\"]","    del recipe[\"instructions\"]","    ","    ","    if form_allergies:","        del recipe[\"allergies[]\"]","        recipe[\"allergies\"]=form_allergies","    else:","        recipe[\"allergies\"]=[\"None\"]","    ","    recipe[\"ingredients\"]=items","    recipe[\"instructions\"]=form_instructions","    recipe[\"user\"]=session['user']","    ","  ","    if request.form.get('submit') == 'submit':","        ","        if recipe[\"image\"]==\"\":","            # If there's no image link provided a image settled as default will be used","            recipe[\"image\"]=\"http://sozkibris.com/wp-content/uploads/2017/10/3dbf0726e1dc41349d0.jpg\"","        ","        # Check allergies, description and recipe name only, to make sure if the key length has a value equals to 0 ","        keys = [key for key,val in recipe.items() if not val]","        # Check  also ingredients and instructions","        keys_ingredients = [val for val in recipe[\"ingredients\"] if not val[\"measurements\"] or not val[\"name\"] or not val[\"quantity\"]]","        keys_instructions = [val for val in recipe[\"instructions\"] if not val]","         # If cuisine not able at the dictionary    ","        if 'cuisine' not in recipe:","            keys.append('cuisine')","        # If diet is not able at the dictionary ","        if 'diet' not in recipe:","            keys.append('diet')","        # If ingredients and instructions have no values into the array, then it will contain empy keys","        if keys_ingredients:","            keys.append('ingredients')","        if keys_instructions:","            keys.append('instructions')","        if keys:","            message=\"This fields are required. Please fill them in.\"","        else:","            recipes=mongo.db.recipes","            recipes.insert_one(recipe)","            flash('The recipe has being added.')","            return redirect(url_for('myrecipes'))","        ","    elif request.form.get('submit') == 'addInstruction':","        instructions += 1","    elif request.form.get('submit') == 'addIngredient': ","        ingredients += 1","    elif request.form.get('submit') == 'del_instruction':","        instructions -= 1 ","    elif request.form.get('submit') == 'del_ingredient':  ","        ingredients -= 1"]}],[{"start":{"row":322,"column":4},"end":{"row":322,"column":6},"action":"insert","lines":["# "],"id":3687},{"start":{"row":323,"column":4},"end":{"row":323,"column":6},"action":"insert","lines":["# "]},{"start":{"row":324,"column":4},"end":{"row":324,"column":6},"action":"insert","lines":["# "]},{"start":{"row":325,"column":4},"end":{"row":325,"column":6},"action":"insert","lines":["# "]},{"start":{"row":326,"column":4},"end":{"row":326,"column":6},"action":"insert","lines":["# "]},{"start":{"row":327,"column":4},"end":{"row":327,"column":6},"action":"insert","lines":["# "]},{"start":{"row":328,"column":4},"end":{"row":328,"column":6},"action":"insert","lines":["# "]},{"start":{"row":329,"column":4},"end":{"row":329,"column":6},"action":"insert","lines":["# "]},{"start":{"row":330,"column":4},"end":{"row":330,"column":6},"action":"insert","lines":["# "]},{"start":{"row":331,"column":4},"end":{"row":331,"column":6},"action":"insert","lines":["# "]},{"start":{"row":332,"column":4},"end":{"row":332,"column":6},"action":"insert","lines":["# "]}],[{"start":{"row":310,"column":12},"end":{"row":310,"column":38},"action":"remove","lines":["recipes.insert_one(recipe)"],"id":3688},{"start":{"row":310,"column":12},"end":{"row":310,"column":77},"action":"insert","lines":["recipes.update_one({'_id': ObjectId(recipe_id)},{\"$set\":recipe}) "]}],[{"start":{"row":232,"column":3},"end":{"row":232,"column":4},"action":"insert","lines":[" "],"id":3689}],[{"start":{"row":314,"column":4},"end":{"row":321,"column":24},"action":"remove","lines":["elif request.form.get('submit') == 'addInstruction':","        instructions += 1","    elif request.form.get('submit') == 'addIngredient': ","        ingredients += 1","    elif request.form.get('submit') == 'del_instruction':","        instructions -= 1 ","    elif request.form.get('submit') == 'del_ingredient':  ","        ingredients -= 1"],"id":3690},{"start":{"row":314,"column":4},"end":{"row":321,"column":30},"action":"insert","lines":["elif request.form.get('submit') == 'addInstruction':","        instructions_length += 1","    elif request.form.get('submit') == 'addIngredient': ","        ingredient_length += 1","    elif request.form.get('submit') == 'del_instruction':","        instructions_length -= 1 ","    elif request.form.get('submit') == 'del_ingredient':  ","        ingredient_length -= 1"]}],[{"start":{"row":247,"column":0},"end":{"row":248,"column":38},"action":"remove","lines":["    ingredientsList = request.form.getlist(\"ingredientName[]\")","    ingredients = len(ingredientsList)"],"id":3691},{"start":{"row":247,"column":0},"end":{"row":248,"column":65},"action":"insert","lines":["    ingredient_length=len(request.form.getlist(\"ingredientName[]\"))","    instructions_length=len(request.form.getlist(\"instructions\"))"]}],[{"start":{"row":321,"column":30},"end":{"row":332,"column":8},"action":"remove","lines":["","    # recipes.update_one( {'_id': ObjectId(recipe_id)},{ \"$set\":","    # {","    #     'user':request.form.get('user'),","    #     'image':request.form.get('recipe_image'),","    #     'recipeName': request.form.get('recipeName'),","    #     'allergy_name': request.form.get('allergy_name'),","    #     'cuisine_name':request.form.get('cuisine_name'),","    #     'ingredients': request.form.get('ingredientName, ingredientQuantity, ingredientMeasurements'),","    #     'instructions':request.form.get('instructions')","    # }","    # })"],"id":3692}],[{"start":{"row":321,"column":30},"end":{"row":322,"column":0},"action":"insert","lines":["",""],"id":3693},{"start":{"row":322,"column":0},"end":{"row":322,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":322,"column":4},"end":{"row":322,"column":8},"action":"remove","lines":["    "],"id":3694}],[{"start":{"row":322,"column":4},"end":{"row":323,"column":0},"action":"insert","lines":["",""],"id":3695},{"start":{"row":323,"column":0},"end":{"row":323,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":323,"column":4},"end":{"row":323,"column":69},"action":"insert","lines":["    recipe=mongo.db.recipes.find_one({\"_id\":ObjectId(recipe_id)})"],"id":3696}],[{"start":{"row":323,"column":4},"end":{"row":323,"column":8},"action":"remove","lines":["    "],"id":3697},{"start":{"row":323,"column":0},"end":{"row":323,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":323,"column":0},"end":{"row":323,"column":4},"action":"insert","lines":["    "],"id":3698}],[{"start":{"row":484,"column":54},"end":{"row":485,"column":0},"action":"insert","lines":["",""],"id":3699},{"start":{"row":485,"column":0},"end":{"row":485,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":485,"column":8},"end":{"row":489,"column":44},"action":"insert","lines":["page_size=9","        page=int(page)","        skips=page_size * (int(page) - 1)","        recipes_per_page=recipes_total_user[skips:skips+(page_size + 1)]       ","        recipes_length=len(recipes_per_page)"],"id":3700}],[{"start":{"row":483,"column":33},"end":{"row":484,"column":55},"action":"insert","lines":["","            recipes_total_count=len(recipes_total_user)"],"id":3701}],[{"start":{"row":484,"column":8},"end":{"row":484,"column":12},"action":"remove","lines":["    "],"id":3702}]]},"ace":{"folds":[{"start":{"row":13,"column":12},"end":{"row":14,"column":40},"placeholder":"..."},{"start":{"row":18,"column":14},"end":{"row":21,"column":43},"placeholder":"..."},{"start":{"row":50,"column":15},"end":{"row":64,"column":43},"placeholder":"..."}],"scrolltop":7596.7998046875,"scrollleft":0,"selection":{"start":{"row":484,"column":8},"end":{"row":484,"column":8},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1567131438589,"hash":"5309c3ed7e7925338468bcd9d4392ae50d579597"}